/*!
 * jQuery Cookie Plugin v1.3
 * https://github.com/carhartl/jquery-cookie
 */
 /*!
 * jQuery UI Widget October 23, 2012
 * http://jqueryui.com
 * http://api.jqueryui.com/jQuery.widget/
 */
 /*!
 * Bootstrap Widget plugin
 *
 * Licensed under the GPL license:
 * http://www.gnu.org/licenses/gpl.html
 *
 */
(function(a,b){a.widget("bootstrap.bwizard",{options:{autoPlay:false,delay:3000,loop:false,hideOption:{fade:true},showOption:{fade:true,duration:400},ajaxOptions:null,cache:false,cookie:null,stepHeaderTemplate:"",panelTemplate:"",spinner:"",backBtnText:"&larr; Previous",nextBtnText:"Next &rarr;",add:null,remove:null,activeIndexChanged:null,show:null,load:null,validating:null},_defaults:{stepHeaderTemplate:"<li>#{title}</li>",panelTemplate:"<div></div>",spinner:"<em>Loading&#8230;</em>"},_create:function(){var c=this;c._pageLize(true)},_init:function(){var d=this.options,c=d.disabled;if(d.disabledState){this.disable();d.disabled=c}else{if(d.autoPlay){this.play()}}},_setOption:function(c,d){a.Widget.prototype._setOption.apply(this,arguments);switch(c){case"activeIndex":this.show(d);break;case"navButtons":this._createButtons();break;default:this._pageLize();break}},play:function(){var d=this.options,c=this,e;if(!this.element.data("intId.bwizard")){e=window.setInterval(function(){var f=d.activeIndex+1;if(f>=c.panels.length){if(d.loop){f=0}else{c.stop();return}}c.show(f)},d.delay);this.element.data("intId.bwizard",e)}},stop:function(){var c=this.element.data("intId.bwizard");if(c){window.clearInterval(c);this.element.removeData("intId.bwizard")}},_normalizeBlindOption:function(d){if(d.blind===b){d.blind=false}if(d.fade===b){d.fade=false}if(d.duration===b){d.duration=200}if(typeof d.duration==="string"){try{d.duration=parseInt(d.duration,10)}catch(c){d.duration=200}}},_createButtons:function(){var e=this,g=this.options,d,c=g.backBtnText,f=g.nextBtnText;this._removeButtons();if(g.navButtons==="none"){return}if(!this.buttons){d=g.navButtons;this.buttons=a('<ul class="pager"/>');this.buttons.addClass("bwizard-buttons");this.backBtn=a("<li class='previous'><a href='#'>"+c+"</a></li>").appendTo(this.buttons).bind({click:function(){e.back();return false}}).attr("role","button");this.nextBtn=a("<li class='next'><a href='#'>"+f+"</a>").appendTo(this.buttons).bind({click:function(){e.next();return false}}).attr("role","button");this.buttons.appendTo(this.element)}},_removeButtons:function(){if(this.buttons){this.buttons.remove();this.buttons=b}},_pageLize:function(f){var d=this,e=this.options,h=/^#.+/;var g=false;this.list=this.element.children("ol,ul").eq(0);var c=this.list.length;if(this.list&&c===0){this.list=null}if(this.list){if(this.list.get(0).tagName.toLowerCase()==="ol"){g=true}this.lis=a("li",this.list);this.lis.each(function(){a(this).find(".label").remove();var j=a(this).index()+1;a(this).css("z-index",d.lis.length-j);a(this).contents().wrap('<span class="hidden-phone"/>');a(this).prepend('<span class="label">'+j+"</span>");if(!g){a(this).find(".label").addClass("visible-phone")}})}if(f){this.panels=a("> div",this.element);this.panels.each(function(k,l){var j=a(l).attr("src");if(j&&!h.test(j)){a.data(l,"load.bwizard",j.replace(/#.*$/,""))}});this.element.addClass("bwizard clearfix");if(this.list){this.list.addClass("bwizard-steps clearfix").attr("role","tablist").attr("role","tab")}this.container=a("<div/>");this.container.addClass("bwizard-body");this.container.append(this.panels);this.container.appendTo(this.element);this.panels.attr("role","tabpanel");if(e.activeIndex===b){if(typeof e.activeIndex!=="number"&&e.cookie){e.activeIndex=parseInt(d._cookie(),10)}if(typeof e.activeIndex!=="number"&&this.panels.filter(".bwizard-activated").length){e.activeIndex=this.panels.index(this.panels.filter(".bwizard-activated"))}e.activeIndex=e.activeIndex||(this.panels.length?0:-1)}else{if(e.activeIndex===null){e.activeIndex=-1}}e.activeIndex=((e.activeIndex>=0&&this.panels[e.activeIndex])||e.activeIndex<0)?e.activeIndex:0;this.panels.addClass("hide").attr("aria-hidden",true);if(e.activeIndex>=0&&this.panels.length){this.panels.eq(e.activeIndex).removeClass("hide").addClass("bwizard-activated").attr("aria-hidden",false);this.load(e.activeIndex)}this._createButtons()}else{this.panels=a("> div",this.container);e.activeIndex=this.panels.index(this.panels.filter(".bwizard-activated"))}this._refreshStep();if(e.cookie){this._cookie(e.activeIndex,e.cookie)}if(e.cache===false){this.panels.removeData("cache.bwizard")}if(e.showOption===b||e.showOption===null){e.showOption={}}this._normalizeBlindOption(e.showOption);if(e.hideOption===b||e.hideOption===null){e.hideOption={}}this._normalizeBlindOption(e.hideOption);this.panels.unbind(".bwizard")},_refreshStep:function(){var c=this.options;if(this.lis){this.lis.removeClass("current").attr("aria-selected",false).find(".label").removeClass("badge-inverse");if(c.activeIndex>=0&&c.activeIndex<=this.lis.length-1){if(this.lis){this.lis.eq(c.activeIndex).addClass("current").attr("aria-selected",true).find(".label").addClass("badge-inverse")}}}if(this.buttons&&!c.loop){this.backBtn[c.activeIndex<=0?"addClass":"removeClass"]("disabled").attr("aria-disabled",c.activeIndex===0);this.nextBtn[c.activeIndex>=this.panels.length-1?"addClass":"removeClass"]("disabled").attr("aria-disabled",(c.activeIndex>=this.panels.length-1))}},_sanitizeSelector:function(c){return c.replace(/:/g,"\\:")},_cookie:function(){var c=this.cookie||(this.cookie=this.options.cookie.name);return a.cookie.apply(null,[c].concat(a.makeArray(arguments)))},_ui:function(c){return{panel:c,index:this.panels.index(c)}},_removeSpinner:function(){var c=this.element.data("spinner.bwizard");if(c){this.element.removeData("spinner.bwizard");c.remove()}},_resetStyle:function(c){c.css({display:""});if(!a.support.opacity){c[0].style.removeAttribute("filter")}},destroy:function(){var c=this.options;this.abort();this.stop();this._removeButtons();this.element.unbind(".bwizard").removeClass(["bwizard","clearfix"].join(" ")).removeData("bwizard");if(this.list){this.list.removeClass("bwizard-steps clearfix").removeAttr("role")}if(this.lis){this.lis.removeClass("current").removeAttr("role");this.lis.each(function(){if(a.data(this,"destroy.bwizard")){a(this).remove()}else{a(this).removeAttr("aria-selected")}})}this.panels.each(function(){var d=a(this).unbind(".bwizard");a.each(["load","cache"],function(e,f){d.removeData(f+".bwizard")});if(a.data(this,"destroy.bwizard")){a(this).remove()}else{a(this).removeClass(["bwizard-activated","hide"].join(" ")).css({position:"",left:"",top:""}).removeAttr("aria-hidden")}});this.container.replaceWith(this.container.contents());if(c.cookie){this._cookie(null,c.cookie)}return this},add:function(d,g){if(d===b){d=this.panels.length}if(g===b){g="Step "+d}var c=this,f=this.options,e=a(f.panelTemplate||c._defaults.panelTemplate).data("destroy.bwizard",true),h;e.addClass("hide").attr("aria-hidden",true);if(d>=this.panels.length){if(this.panels.length>0){e.insertAfter(this.panels[this.panels.length-1])}else{e.appendTo(this.container)}}else{e.insertBefore(this.panels[d])}if(this.list&&this.lis){h=a((f.stepHeaderTemplate||c._defaults.stepHeaderTemplate).replace(/#\{title\}/g,g));h.addClass("ui-widget-header ui-corner-all ui-priority-secondary").data("destroy.bwizard",true);if(d>=this.lis.length){h.appendTo(this.list)}else{h.insertBefore(this.lis[d])}}this._pageLize();if(this.panels.length===1){f.activeIndex=0;h.addClass("ui-priority-primary");e.removeClass("hide").addClass("bwizard-activated").attr("aria-hidden",false);this.element.queue("bwizard",function(){c._trigger("show",null,c._ui(c.panels[0]))});this._refreshStep();this.load(0)}this._trigger("add",null,this._ui(this.panels[d]));return this},remove:function(c){var e=this.options,d=this.panels.eq(c).remove();this.lis.eq(c).remove();if(c<e.activeIndex){e.activeIndex--}this._pageLize();if(d.hasClass("bwizard-activated")&&this.panels.length>=1){this.show(c+(c<this.panels.length?0:-1))}this._trigger("remove",null,this._ui(d[0]));return this},_showPanel:function(f){var c=this,g=this.options,e=a(f),d;e.addClass("bwizard-activated");if((g.showOption.blind||g.showOption.fade)&&g.showOption.duration>0){d={duration:g.showOption.duration};if(g.showOption.blind){d.height="toggle"}if(g.showOption.fade){d.opacity="toggle"}e.hide().removeClass("hide").animate(d,g.showOption.duration||"normal",function(){c._resetStyle(e);c._trigger("show",null,c._ui(e[0]));c._removeSpinner();e.attr("aria-hidden",false);c._trigger("activeIndexChanged",null,c._ui(e[0]))})}else{e.removeClass("hide").attr("aria-hidden",false);c._trigger("show",null,c._ui(e[0]));c._removeSpinner();c._trigger("activeIndexChanged",null,c._ui(e[0]))}},_hidePanel:function(f){var d=this,g=this.options,c=a(f),e;c.removeClass("bwizard-activated");if((g.hideOption.blind||g.hideOption.fade)&&g.hideOption.duration>0){e={duration:g.hideOption.duration};if(g.hideOption.blind){e.height="toggle"}if(g.hideOption.fade){e.opacity="toggle"}c.animate(e,g.hideOption.duration||"normal",function(){c.addClass("hide").attr("aria-hidden",true);d._resetStyle(c);d.element.dequeue("bwizard")})}else{c.addClass("hide").attr("aria-hidden",true);this.element.dequeue("bwizard")}},show:function(f){if(f<0||f>=this.panels.length){return this}if(this.element.queue("bwizard").length>0){return this}var d=this,h=this.options,e=a.extend({},this._ui(this.panels[h.activeIndex])),c,g;e.nextIndex=f;e.nextPanel=this.panels[f];if(this._trigger("validating",null,e)===false){return this}c=this.panels.filter(":not(.hide)");g=this.panels.eq(f);h.activeIndex=f;this.abort();if(h.cookie){this._cookie(h.activeIndex,h.cookie)}this._refreshStep();if(g.length){if(c.length){this.element.queue("bwizard",function(){d._hidePanel(c)})}this.element.queue("bwizard",function(){d._showPanel(g)});this.load(f)}else{throw"Bootstrap Wizard: Mismatching fragment identifier."}return this},next:function(){var d=this.options,c=d.activeIndex+1;if(d.disabled){return false}if(d.loop){c=c%this.panels.length}if(c<this.panels.length){this.show(c);return true}return false},back:function(){var d=this.options,c=d.activeIndex-1;if(d.disabled){return false}if(d.loop){c=c<0?this.panels.length-1:c}if(c>=0){this.show(c);return true}return false},load:function(e){var c=this,h=this.options,f=this.panels.eq(e)[0],d=a.data(f,"load.bwizard"),g;this.abort();if(!d||this.element.queue("bwizard").length!==0&&a.data(f,"cache.bwizard")){this.element.dequeue("bwizard");return}if(h.spinner){g=this.element.data("spinner.bwizard");if(!g){g=a('<div class="modal" id="spinner" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"/>');g.html(h.spinner||c._defaults.spinner);g.appendTo(document.body);this.element.data("spinner.bwizard",g);g.modal()}}this.xhr=a.ajax(a.extend({},h.ajaxOptions,{url:d,dataType:"html",success:function(j,i){a(f).html(j);if(h.cache){a.data(f,"cache.bwizard",true)}c._trigger("load",null,c._ui(c.panels[e]));try{if(h.ajaxOptions&&h.ajaxOptions.success){h.ajaxOptions.success(j,i)}}catch(k){}},error:function(k,i){c._trigger("load",null,c._ui(c.panels[e]));try{if(h.ajaxOptions&&h.ajaxOptions.error){h.ajaxOptions.error(k,i,e,f)}}catch(j){}}}));c.element.dequeue("bwizard");return this},abort:function(){this.element.queue([]);this.panels.stop(false,true);this.element.queue("bwizard",this.element.queue("bwizard").splice(-2,2));if(this.xhr){this.xhr.abort();delete this.xhr}this._removeSpinner();return this},url:function(d,c){this.panels.eq(d).removeData("cache.bwizard").data("load.bwizard",c);return this},count:function(){return this.panels.length}})}(jQuery));